<!DOCTYPE html>
<html>
<head>
<meta charset='utf-8'>
<title>3D Modeling and Texturing</title>
    
<link href="css/site.css" media="screen" rel="stylesheet" type="text/css" />
<link href="css/highlight.default.css" media="screen" rel="stylesheet" type="text/css" />
  
<script src="js/jquery.js"></script>
<script src="js/showdown.js" type="text/javascript"></script>

<link rel="icon" type="image/x-icon" href="favicon.ico" />
</head>
<body>
<!--
Write the markdown code below.
A guide to markdown syntax is at http://daringfireball.net/projects/markdown/
-->

<div style="display: none" id="sourcetext">

## Review
- [Tumblr](http://2014ant3012.tumblr.com/)

[Maya 2014 online Help](http://download.autodesk.com/global/docs/maya2014/en_us/)    
Reference: Maya® Studio Projects Texturing and Lighting, Mastering Autodesk Maya 2013.

# Rendering
Rendering is the final stage in the 3D computer graphics production process.
Though the wider context of rendering begins with shading and texturing objects and lighting your scene, the rendering process ends when surfaces, materials, lights, and motion are processed into a final image or image sequence.

As you build your scenes (shade and texture objects, light scenes, position cameras, and so on), you’ll want to visualize your scene many times before you produce the final rendered image or image sequence. This process may involve (depending on your particular project) creating and setting up additional cameras.

The key to rendering is finding a balance between the visual complexity required and the rendering speed that determines how many frames can be rendered in a given period of time.
 
# Global Illumination: indirect illumination

In reality, **when a ray of light hits an opaque surface, it is either absorbed or reflected (or a little of both) by the surface**. If the light ray is reflected, it reenters the environment and continues to bounce off reflected surfaces until it is absorbed by another surface.      
As light rays bounce around in an environment, fewer light rays reach the parts that are hidden in corners, cracks, and crevices. The lack of light in these areas creates a type of shadowing known as **ambient occlusion**. 

Perhaps **80 percent of the illumination** in an environment is contributed by indirect illumination, and simulating its effect is critical to creating realistic renderings.

![gl00](img/maya/rendering/gl/gl.png)

## Mental Ray 
**Mental ray** for Maya offers all the features traditionally expected of **photorealistic rendering** and includes functionality not found in most rendering software.    
mental ray for Maya allows interactive and batch mental ray rendering from within the Maya user interface.    
After you load the mental ray plug-in (and select mental ray as the renderer), the Render menu lists available menu items for mental ray for Maya. As well, the Attribute Editor contains a mental ray section in which you can edit attributes that are used exclusively when rendering with mental ray for Maya.

To use Global Illumination, you must use the mental ray renderer.     
For simulating indirect lighting and ambient occlusion shadowing, there are **Global Illumination, Final Gathering**, and **Ambient Occlusion shaders.** You can use them separately or together. 

## Photon
To use Global Illumination, you must employ **virtual [photons](http://en.wikipedia.org/wiki/Photon)**. In Maya, **spot, point, area,** and **directional** lights generate photons when the **light's Emit Photons attribute** is selected.

![gl02](img/maya/rendering/gl/lid.png) 

When a scene is rendered, photons are traced from each photon-emitting light to surfaces in the scene. If a photon “hits” a surface, that photon is absorbed, reflected, or transmitted (refracted) based on the qualities of the material assigned to the surface. If a photon is reflected or transmitted, it survives with only a portion of its original energy. 

> #### Material: The amount of energy is determined by the **reflection coefficient** which is established by the **reflectivity attribute** of the assigned material. Attributes that establish the surface's **diffuse, color,** and **various specular highlight qualities** have an equal impact. 

If a photon survives a hit and is reflected or transmitted, it continues through the scene until it hits another surface. Once again, the photon is absorbed, reflected, or transmitted. This process continues until the surviving photons are stopped by the **Max Photon Depth attribute**, which defines the number of hits permitted per photon. (Max Photon depth is located in the **Render Settings window / Indirect Lighting tab / Photon Tracing section**)

![gl01](img/maya/rendering/gl/rtd.png)

**Photon Reflections** defines the maximum number of times a photon will reflect in a scene. This attribute is overridden by the Max Photon Depth attribute. The first surface encountered is not included in the count. Photon Refractions functions in the same manner but affects the maximum number of photon refractions.

### Photon map
The photons that are culled in a process known as Russian Roulette and thereby absorbed by the surface have their position, incident direction, and energy stored in a special photon map.

To save a photon map, type a name for the map in the **Photon Map File field** (found in the Photon Map section on the Indirect Lighting tab of the Render Settings window) and create a render (do not add a file extension to the name). When you want to reuse the same map, deselect Rebuild Photon Map. The map is stored in the renderData\mentalray\photonMap directory with the .pmap extension. When you want to overwrite the map, simply select Rebuild Photon Map.

The map Visualizer allows you to see how the photons are cast in the scene.

![gl01_01](img/maya/rendering/gl/phm.png)

### Light's Global Illum Photons attribute
You can lower or raise the default value of 10,000 to decrease or increase quality. 

### Light's Caustic And Global Illumination subsection  
**Photon Color** represents the red, green, and blue components of a photon's energy. 
The RGB values of its color swatch are multiplied by the Photon Intensity attribute to produce Energy R, Energy G, and Energy B attributes.

**Photon Intensity** is a scaling factor used to determine the intensity of photons produced by a light. A value of 0 will turn off photon tracing for the light.

**Exponent** simulates light falloff over distance. The default value of 2 replicates natural, quadratic decay. A value of 1 effectively prevents falloff from occurring. Values higher than 2 create a more rapid falloff by artificially decreasing photon energy with distance.

### The Global Illumination section of the Indirect Lighting tab in the Render Settings window.

![gl03](img/maya/rendering/gl/rid.png) 

**Radius** controls the maximum distance from a surface point that the renderer will seek out photon hits to determine the color of the point in question. If photons hits are within the search region, their energies are averaged. The search regions render as colored discs when the Radius is inappropriately small for a scene or there are an insufficient number of photons present. The default value of 0 allows Maya to automatically pick a Radius based on the scene size.

**Accuracy** sets the maximum number of neighboring photon hits included in the color estimate of a single rendered point. The search for neighboring photon hits is limited to the region established by the Radius attribute. In general, the higher the Accuracy value, the smoother the result. However, Accuracy affects only photon hits that are in close proximity. That is, if the photon count is low or the Radius value is small so that the photon hits are not discovered in the search region, the Accuracy attribute will have no effect on the render.

**Scale** serves as a multiplier for the Photon Intensity attribute of all lights in the scene. If the slider is set to 50 percent gray, all the photons in the scene will be at half intensity.

**Merge Distance** specifies a distance in world space within which overlapping photons are merged. The option is used to reduce the size of photon maps and decrease render times. You should raise this setting by very small increments. It can increase the blotchy look of the render.

## Final Gather 
Final Gather is used alone for outdoor scenes or can be combined with GI for the highest-quality results on interior scenes. Final Gather does require your scene to be properly illuminated with some form of direct lighting for it to produce good results. For a pleasing and accurate simulation, you will need perhaps a minimum one-third to one-half of the scene lit with direct light. However when higher settings are used, it can often take much longer than the rendering itself.

![gl05](img/maya/rendering/gl/fg01.png) 

Final Gather employs a specialized variation of raytracing in which each camera eye ray intersection creates sets of Final Gather rays. The Final Gather rays are sent out in a random direction within a hemisphere. The end result is a render that is able to include bounced light and color bleed.

## Practice Global Illumination and Final Gathering

### Prepare the scene in the right project directory.
- Let's use the Cornell box and its area light set-up.

### Render Settings window
- Choose Mental Ray renderer.
- In the **Global Illumination** section, select the Global Illumination check box. 
- In the **Final Gathering** section, temporarily deselect Final Gathering: temporarily disabling Final Gathering will speed up the render as you adjust the various Global Illumination settings.

### the Attribute Editor tab for the area light
- In the **Caustic And Global Illumination** section, select **Emit Photons**. Render a test. Each dot represents a photon hit. 

- The dot indicates the area of influence the photon has when combining the photon's indirect illumination information with the direct illumination calculation. 

- The dots are colored, indicating that their energy has been influenced by a surface they have bounced off. For example, the red dots indicate a bounce off a nearby red wall. Hence, a major advantage of Global Illumination is the ability to produce **color bleed**. Although Final Gathering is also used to produce bleed, it is generally more subtle.

- Adjust the **Radius** attribute, found in the Global Illumination section of the Render Settings window. By default, Radius is set to 0, which means that Maya automatically selects a Radius value based on the scene size. 

- It's important to adjust **the total number of photons** in the scene at the same time. To do so, adjust the Global Illum Photons value in the Caustic And Global Illumination section of the light's Attribute Editor tab. When raising the Global Illum Photons value, do so incrementally. The more photons that are being traced, the longer the render will take.

- Reactivate **Final Gathering** by selecting the Final Gathering check box. Final Gathering provides additional smoothing to the Global Illumination indirect illumination and helps hide unblended photon hits.

![gl04](img/maya/rendering/gl/fg.png) 

## Caustics
Global illumination simulates light reflected from diffuse surfaces. Caustics simulate light reflected from glossy and reflective surfaces as well as light that passes through refractive transparent materials. Caustics are calculated completely independently from global illumination; however, the workflow is very similar.

![gl06](img/maya/rendering/gl/cst.png) 

## Homework
- Upload your GI rendering image by next class.

## Final project
- Submit one folder (yourname\_3Dmodeling) which includes one pdf documentation, the final render image (HD size), maya file + textures by June 22 12pm to yoon\_goo@naver.com. Please name all your documentation as (your name\_title)

- Theme: imply your interpretation of 'Memory' & 'Relations' applying multiple textures in a more complex shading network. 
- Review: June 25th, 1:30 pm, X-427. 

</div>
<div id="wrapper">
	
	<div class="header">
		
		<h1>ANT3012</h1>		
		<a href="index.html">Overview</a><br/>
		<a href="intro.html">Introduction</a><br/><br/>

		<a href="mayafundt.html">Maya Fundamental</a><br/>
		<a href="mayaNURBs.html">Maya NURBs</a><br/>
		<a href="mayaPoly01.html">Maya Polygon I</a><br/>
		<a href="mayaShade.html">Maya Shading & Lighting I</a><br/>
		<a href="maya_vrfilmking.html">Virtual Filmmaking</a><br/>	
		<br/><a href="mayaShade01.html">Maya Shading & Lighting II</a><br/>	
		<a href="mayaTexture.html">Maya Texturing</a><br/>	
		<a href="mayaPoly02.html">Maya Polygon II: Organic Modeling</a><br/>
		<a href="mayaRender.html">Maya Rendering</a><br/>

	</div>
	<div class="section">
		<script type="text/javascript">
		//var converter = new Markdown.Converter();
		var converter = new Showdown.converter();
		document.write(converter.makeHtml($('#sourcetext').text()));
		</script>
	</div>
	
	<div class="footer">HyunKyung (Haru) Ji, 2014</div>
	
</div>
</body>
</html>